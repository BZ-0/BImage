#version 300 es
precision highp float;precision highp int;precision highp sampler2D;precision highp usampler2D;in highp vec2 texcoord;uniform highp sampler2D img_rgb,img_a;layout(location=0) out highp vec4 fragColor;uniform vec2 rxy,gxy,bxy,wxy;uniform float gamma;void main(){mat3x3 h=transpose(mat3x3(vec3(rxy,1.f-rxy.x-rxy.y),vec3(gxy,1.f-gxy.x-gxy.y),vec3(bxy,1.f-bxy.x-bxy.y))),y;vec3 v=vec3(wxy,1.f-wxy.x-wxy.y)/wxy.y*inverse(h);for(uint f=0u;f<3u;f++)for(uint u=0u;u<3u;u++)h[u][f]*=v[f];y=mat3x3(.4124564,.3575761,.1804375,.2126729,.7151522,.072175,.0193339,.119192,.9503041)*inverse(h);fragColor=vec4(pow(texture(img_rgb,texcoord.xy).xyz*y,vec3(.45f/gamma)),texture(img_a,texcoord.xy).x);}